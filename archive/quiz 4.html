<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RME Deep Diagnostic</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-dark: #134e4a;
            --color-accent: #0d9488;
            --color-accent-hover: #0f766e;
            --color-light: #f0fdfa;
            --color-white: #ffffff;
            --color-border: #e2e8f0;
            --font: 'Inter', sans-serif;
        }

        body {
            font-family: var(--font);
            background-color: var(--color-light);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: var(--color-dark);
        }

        .diagnostic-card {
            width: 100%;
            max-width: 700px;
            background: var(--color-white);
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.08);
            overflow: hidden;
            border: 1px solid var(--color-border);
            position: relative;
        }

        /* HEADER */
        .diag-header {
            padding: 24px 40px;
            border-bottom: 1px solid var(--color-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #fff;
        }
        
        .diag-logo { font-weight: 700; font-size: 16px; letter-spacing: -0.01em; color: var(--color-dark); }
        .diag-step { font-size: 14px; color: #64748b; font-weight: 500; }

        /* BODY */
        .diag-body {
            padding: 40px;
            min-height: 400px; /* Kept height consistent */
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* QUESTIONS */
        .question-text {
            font-size: 26px;
            font-weight: 600;
            margin-bottom: 32px;
            line-height: 1.3;
            color: var(--color-dark);
        }

        .options-grid {
            display: grid;
            gap: 12px;
        }

        .option-btn {
            text-align: left;
            padding: 20px 24px;
            background: #fff;
            border: 2px solid var(--color-border);
            border-radius: 8px;
            font-size: 17px;
            color: var(--color-dark);
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            font-family: var(--font);
        }

        .option-btn:hover {
            border-color: var(--color-accent);
            background: var(--color-light);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(13, 148, 136, 0.1);
        }

        /* RESULTS VIEW */
        .results-view { display: none; text-align: center; }
        
        .score-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 16px;
            margin-bottom: 32px;
            margin-top: 24px;
        }

        .score-card {
            background: var(--color-light);
            padding: 16px;
            border-radius: 8px;
            border: 1px solid var(--color-accent);
        }

        .score-label { font-size: 13px; text-transform: uppercase; letter-spacing: 0.05em; font-weight: 600; opacity: 0.8; margin-bottom: 8px; }
        .score-value { font-size: 24px; font-weight: 700; color: var(--color-accent); }

        .verdict-headline { font-size: 32px; font-weight: 700; margin-bottom: 16px; line-height: 1.1; color: var(--color-dark); }
        .verdict-subhead { font-size: 18px; color: #475569; margin-bottom: 32px; line-height: 1.5; }

        .recommendation-box {
            background: #f8fafc;
            border-left: 4px solid var(--color-dark);
            padding: 24px;
            text-align: left;
            margin-bottom: 32px;
            border-radius: 0 8px 8px 0;
        }

        .cta-btn {
            display: inline-block;
            background: var(--color-accent);
            color: white;
            padding: 16px 32px;
            border-radius: 8px;
            font-weight: 600;
            text-decoration: none;
            font-size: 18px;
            transition: all 0.2s;
            border: none;
            cursor: pointer;
            width: 100%;
        }
        .cta-btn:hover { background: var(--color-accent-hover); }

        /* LOADING ANIMATION */
        .loading-view { display: none; text-align: center; padding: 20px; }
        .spinner {
            width: 50px; height: 50px; border: 4px solid var(--color-light);
            border-top: 4px solid var(--color-accent); border-radius: 50%;
            animation: spin 1s linear infinite; margin: 0 auto 24px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .loading-text { font-size: 18px; font-weight: 600; margin-bottom: 8px; color: var(--color-dark); }
        .loading-sub { font-size: 14px; color: #64748b; }

        /* ANIMATIONS */
        .fade-in { animation: fadeIn 0.4s ease forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    </style>
</head>
<body>

<div class="diagnostic-card">
    <div class="diag-header">
        <div class="diag-logo">RME Diagnostic</div>
        <div class="diag-step" id="step-indicator">Step 1 of 4</div>
    </div>

    <div class="diag-body">
        
        <div id="question-container" class="fade-in">
            <h2 class="question-text" id="q-text">Why are you here right now?</h2>
            <div class="options-grid" id="q-options">
                </div>
        </div>

        <div id="loading-view" class="loading-view">
            <div class="spinner"></div>
            <div class="loading-text" id="loading-main">Analyzing List Composition...</div>
            <div class="loading-sub" id="loading-sub">Comparing against known ISP parameters</div>
        </div>

        <div id="results-view" class="results-view">
            <h2 class="verdict-headline" id="res-headline">Your Verdict</h2>
            <p class="verdict-subhead" id="res-subhead">Description</p>

            <div class="score-grid">
                <div class="score-card">
                    <div class="score-label">Hygiene</div>
                    <div class="score-value" id="score-hygiene">B-</div>
                </div>
                <div class="score-card">
                    <div class="score-label">Infrastructure</div>
                    <div class="score-value" id="score-infra">A</div>
                </div>
                <div class="score-card">
                    <div class="score-label">Strategy</div>
                    <div class="score-value" id="score-strat">C</div>
                </div>
            </div>

            <div class="recommendation-box">
                <h4 style="margin: 0 0 8px 0; font-size: 14px; text-transform: uppercase; color: #64748b; font-weight: 700; letter-spacing: 0.05em;">Expert Prescription</h4>
                <p id="res-prescription" style="margin: 0; font-size: 16px; line-height: 1.6; color: #334155;">Prescription goes here.</p>
            </div>

            <button class="cta-btn" onclick="window.location.href='https://anchor.reviewmyemails.com/'">Upload List for Deep Scan</button>
        </div>

    </div>
</div>

<script>
    // --- DATA & LOGIC ENGINE ---
    
    // State
    let currentTrack = null; 
    let stepCount = 1;
    // Default Scores (Mid-range start)
    let finalScores = { hygiene: 'C+', infra: 'B', strat: 'C' };

    // The Questions Data
    const questions = {
        start: {
            text: "Why are you here right now?",
            options: [
                { text: "I'm in trouble (ESP warning, blocklist, bounces)", next: 'crisis_1', track: 'CRISIS' },
                { text: "I'm confused (Open rates dropping, weird data)", next: 'invest_1', track: 'INVESTIGATION' },
                { text: "I'm optimizing (Just want to be safe/grow)", next: 'audit_1', track: 'AUDIT' }
            ]
        },
        
        // --- TRACK A: CRISIS ---
        crisis_1: {
            text: "Do you know exactly what triggered the alarm?",
            options: [
                { text: "Yes, I hit a Spam Trap / Blocklist.", next: 'crisis_source', scoreUpdate: { infra: 'D', hygiene: 'F' } },
                { text: "Yes, my ESP suspended me.", next: 'crisis_source', scoreUpdate: { infra: 'C', hygiene: 'D' } },
                { text: "No, everything just broke.", next: 'invest_1', scoreUpdate: { infra: 'C', hygiene: 'C' } } 
            ]
        },
        crisis_source: {
            text: "Be honest: Did you buy, rent, or scrape this list?",
            options: [
                { text: "Yes / Maybe / It's complicated.", next: 'result_gambler', scoreUpdate: { strat: 'F', hygiene: 'F' } },
                { text: "No, it's 100% organic opt-in.", next: 'result_crisis_organic', scoreUpdate: { strat: 'B', hygiene: 'B' } }
            ]
        },

        // --- TRACK B: INVESTIGATION ---
        invest_1: {
            text: "How would you describe your Open Rate trend?",
            options: [
                { text: "Slow, steady decline over months.", next: 'invest_hygiene', scoreUpdate: { strat: 'C' } },
                { text: "Sudden drop off a cliff.", next: 'invest_auth', scoreUpdate: { infra: 'D' } },
                { text: "Wildly inconsistent (some high, some low).", next: 'invest_hygiene', scoreUpdate: { strat: 'D' } }
            ]
        },
        invest_auth: {
            text: "Let's rule out the basics. Is your domain authenticated (DMARC/DKIM)?",
            options: [
                { text: "Yes, DMARC is set to 'Reject' or 'Quarantine'.", next: 'result_tech_good', scoreUpdate: { infra: 'A+' } },
                { text: "I think so? / What is DMARC?", next: 'result_tech_bad', scoreUpdate: { infra: 'F' } }
            ]
        },
        invest_hygiene: {
            text: "How do you handle inactive subscribers?",
            options: [
                { text: "I delete them automatically (3-6 months).", next: 'result_false_positive', scoreUpdate: { hygiene: 'A', strat: 'B' } },
                { text: "I keep them just in case they buy later.", next: 'result_hoarder', scoreUpdate: { hygiene: 'F', strat: 'D' } }
            ]
        },

        // --- TRACK C: AUDIT ---
        audit_1: {
            text: "What is your Signup Flow?",
            options: [
                { text: "Single Opt-in (Immediate add).", next: 'audit_track', scoreUpdate: { hygiene: 'C', infra: 'B' } },
                { text: "Double Opt-in (Confirmation email).", next: 'audit_track', scoreUpdate: { hygiene: 'A', infra: 'A' } }
            ]
        },
        audit_track: {
            text: "Do you track engagement by Domain (Gmail vs Outlook)?",
            options: [
                { text: "No, just overall rates.", next: 'result_blind', scoreUpdate: { strat: 'C' } },
                { text: "Yes, and one is performing worse.", next: 'result_reputation', scoreUpdate: { strat: 'A' } }
            ]
        }
    };

    // Results Data
    const results = {
        result_gambler: {
            headline: "Critical Risk: Toxic Source",
            subhead: "You cannot 'validate' a purchased list into safety. Validation tools check if an email exists, not if it's a trap.",
            scores: { hygiene: 'F', infra: 'C-', strat: 'F' },
            prescription: "Stop sending immediately. Your domain is likely already flagged. We need to identify the specific acquisition source that is poisoning your pool."
        },
        result_crisis_organic: {
            headline: "Verdict: Reputation Crash",
            subhead: "Your list is organic, but you hit a hidden tripwire (likely a recycled spam trap or engagement filter).",
            scores: { hygiene: 'C', infra: 'B', strat: 'B-' },
            prescription: "Validation alone won't fix this because the emails are 'real.' We need to analyze your engagement data to find the 'Zombie' segment causing the block."
        },
        result_hoarder: {
            headline: "Diagnosis: List Hoarding",
            subhead: "You are prioritizing 'Potential Revenue' over 'Actual Reach'.",
            scores: { hygiene: 'F', infra: 'B', strat: 'D' },
            prescription: "Keeping inactive subscribers tells Gmail you are a low-quality sender. We need to identify which inactives are safe to re-engage and which are dead weight."
        },
        result_tech_bad: {
            headline: "Diagnosis: Infrastructure Gap",
            subhead: "Your content might be great, but your technical ID card is missing.",
            scores: { hygiene: 'B', infra: 'F', strat: 'C' },
            prescription: "Before we clean your list, we must fix your authentication. You are likely landing in spam because ISPs can't verify who you are."
        },
        result_tech_good: {
            headline: "Diagnosis: Data Decay",
            subhead: "Your tech is perfect, which means the problem is definitely your data quality.",
            scores: { hygiene: 'C', infra: 'A+', strat: 'B' },
            prescription: "Since your auth is good, your drop in open rates comes from 'Ghosting'. We need to scan for 'Valid but Toxic' addresses that standard tools miss."
        },
        result_false_positive: {
            headline: "Verdict: Blind Validation",
            subhead: "You are cleaning *too* aggressively based on bad data.",
            scores: { hygiene: 'A+', infra: 'A', strat: 'C' },
            prescription: "You are likely deleting good leads because automated tools marked them as 'Risky' without context. We need to recover your lost revenue."
        },
        result_blind: {
            headline: "Verdict: The Blindfolded Sender",
            subhead: "You have good hygiene, but you are missing the 'Ghosting' signal.",
            scores: { hygiene: 'B', infra: 'B', strat: 'C' },
            prescription: "Your overall open rate looks fine, but you are likely blocked at one specific provider (like Microsoft). We need to run a domain-level audit."
        },
        result_reputation: {
            headline: "Verdict: Provider Specific Block",
            subhead: "You are doing everything right, but one ISP hates you.",
            scores: { hygiene: 'A', infra: 'B', strat: 'A' },
            prescription: "This is a reputation repair job. We need to isolate that specific domain segment and warm it up manually while keeping the rest active."
        }
    };

    // --- RENDER FUNCTIONS ---

    const qContainer = document.getElementById('question-container');
    const qText = document.getElementById('q-text');
    const qOptions = document.getElementById('q-options');
    const stepInd = document.getElementById('step-indicator');
    const loadingView = document.getElementById('loading-view');
    const resultsView = document.getElementById('results-view');
    const loadMain = document.getElementById('loading-main');
    const loadSub = document.getElementById('loading-sub');

    function renderQuestion(qKey) {
        // Animation reset
        qContainer.classList.remove('fade-in');
        void qContainer.offsetWidth; // trigger reflow
        qContainer.classList.add('fade-in');

        const q = questions[qKey];
        qText.innerText = q.text;
        qOptions.innerHTML = '';
        stepInd.innerText = `Step ${stepCount} of 4`; 

        q.options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = opt.text;
            btn.onclick = () => handleAnswer(opt, qKey);
            qOptions.appendChild(btn);
        });
    }

    function handleAnswer(option, currentQKey) {
        stepCount++;
        
        // Track Logic
        if (option.track) currentTrack = option.track;
        
        // Score Logic
        if (option.scoreUpdate) {
            finalScores = { ...finalScores, ...option.scoreUpdate };
        }

        // Routing
        if (option.next.startsWith('result_')) {
            showLoading(option.next);
        } else {
            renderQuestion(option.next);
        }
    }

    function showLoading(resultKey) {
        qContainer.style.display = 'none';
        stepInd.style.display = 'none';
        loadingView.style.display = 'block';

        // Fake loading stages for "Expert" feel
        setTimeout(() => {
            loadMain.innerText = "Checking Authentication Protocols...";
            loadSub.innerText = "Verifying DMARC alignment patterns";
        }, 800);
        
        setTimeout(() => {
            loadMain.innerText = "Calculating Risk Score...";
            loadSub.innerText = "Weighting hygiene vs strategy";
        }, 1600);

        setTimeout(() => {
            loadingView.style.display = 'none';
            showResult(resultKey);
        }, 2500); 
    }

    function showResult(key) {
        const res = results[key];
        
        // Update DOM
        document.getElementById('res-headline').innerText = res.headline;
        document.getElementById('res-subhead').innerText = res.subhead;
        document.getElementById('res-prescription').innerText = res.prescription;
        
        // Use logic scores if defined in result, otherwise accumulated scores
        const scores = res.scores || finalScores;
        
        setScore('score-hygiene', scores.hygiene);
        setScore('score-infra', scores.infra);
        setScore('score-strat', scores.strat);

        resultsView.style.display = 'block';
        resultsView.classList.add('fade-in');
    }

    function setScore(id, grade) {
        const el = document.getElementById(id);
        el.innerText = grade;
        
        // Color coding
        if (grade.includes('A') || grade.includes('B')) el.style.color = '#0d9488'; // Green
        else if (grade.includes('C')) el.style.color = '#eab308'; // Yellow
        else el.style.color = '#ef4444'; // Red
    }

    // Init
    renderQuestion('start');

</script>

</body>
</html>